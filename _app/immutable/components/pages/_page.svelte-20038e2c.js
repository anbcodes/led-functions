import{S as Pe,i as be,s as Le,k as v,q as U,a as x,l as A,m as R,r as k,h as w,c as B,n as u,b as ve,G as s,I as L,B as _e,J as Ne,K as Ae,o as De,L as W,M as le,u as ae}from"../../chunks/index-4a8f3127.js";const J={INVALID:0,SIN:1,ADD:2,SUB:3,MUL:4,DIV:5,POW:6,MOD:7,IF:8,EQ:9,GT:10,LT:11,AND:12,OR:13,VAL:14,VAR_T:15,VAR_I:16,END:17},Ce=J,Se=e=>e.split("").map((t,n)=>t==="("?{type:"OPEN_PARAN",rawValue:t,index:n}:t===")"?{type:"CLOSE_PARAN",rawValue:t,index:n}:t===" "?{type:"WHITESPACE",rawValue:t,index:n}:t==="+"?{type:"OPERATOR",operator:"ADD",rawValue:t,index:n}:t==="-"?{type:"OPERATOR",operator:"SUB",rawValue:t,index:n}:t==="*"?{type:"OPERATOR",operator:"MUL",rawValue:t,index:n}:t==="/"?{type:"OPERATOR",operator:"DIV",rawValue:t,index:n}:t==="%"?{type:"OPERATOR",operator:"MOD",rawValue:t,index:n}:t==="^"?{type:"OPERATOR",operator:"POW",rawValue:t,index:n}:t===">"?{type:"OPERATOR",operator:"GT",rawValue:t,index:n}:t==="<"?{type:"OPERATOR",operator:"LT",rawValue:t,index:n}:t==="="?{type:"OPERATOR",operator:"EQ",rawValue:t,index:n}:t===","?{type:"OPERATOR",operator:"SEP",rawValue:t,index:n}:t==="&"?{type:"OPERATOR",operator:"AND",rawValue:t,index:n}:t==="|"?{type:"OPERATOR",operator:"OR",rawValue:t,index:n}:{type:"LITERAL",value:t,rawValue:t,index:n}),me=[["SEP"],["AND","OR"],["GT","LT","EQ"],["MOD"],["ADD","SUB"],["DIV","MUL"]];class Q extends Error{constructor(t,n){super(t),this.index=n}}const K=(e,t)=>{if(e.length===0)throw new Q("Expected an expression",t);for(let o=0;o<me.length;o++){const i=me[o];let E=0;for(let g=0;g<e.length;g++){const a=e[g];if(a.type==="OPEN_PARAN"&&(E+=1),a.type==="CLOSE_PARAN"&&(E-=1),a.type==="OPERATOR"&&E==0&&i.includes(a.operator))return{type:"operator",op:a.operator,a:K(e.slice(0,g),e[0].index+1),b:K(e.slice(g+1),a.index+1),index:a.index}}}let n="",l=-1;for(let o=0;o<e.length;o++){const i=e[o];if(i.type==="LITERAL"&&(n+=i.value,l===-1&&(l=i.index)),i.type==="OPEN_PARAN"){if(e.slice(-1)[0].type!=="CLOSE_PARAN")throw new Q("Unmatched opening parenthesis",i.index);if(n){const E=K(e.slice(o+1,-1),i.index),g=[],a=O=>{O.type==="operator"&&O.op==="SEP"?(a(O.a),a(O.b)):g.push(O)};return a(E),{type:"call",name:n,args:g,index:l}}else return K(e.slice(o+1,-1),i.index)}}const y=e.find(o=>o.type!=="LITERAL");if(y)throw new Q(`Unexpected token: ${y.rawValue}`,y.index);return n=e.map(o=>o.value).join(""),isNaN(parseInt(n,10))?{type:"variable",name:n,index:e[0].index}:{type:"value",val:parseInt(n,10),index:e[0].index}},H=e=>{if(e.type==="call"){if(e.name==="if")return[...H(e.args[0]),...H(e.args[1]),...H(e.args[2]),J.IF];if(e.name==="sin")return[...H(e.args[0]),J.SIN];throw new Q(`Invalid function: ${e.name}`,e.index)}else if(e.type==="operator"){const t=Ce[e.op];if(t===void 0)throw new Q(`Invalid operator: ${e.op}`,e.index);return[...H(e.a),...H(e.b),t]}else{if(e.type==="value")return[J.VAL,e.val];if(e.type==="variable"){if(e.name==="i")return[J.VAR_I];if(e.name==="t")return[J.VAR_T];throw new Q(`Unknown variable: ${e.name}`,e.index)}else throw new Error("INVALID TYPE")}},Ue=e=>{try{const t=Se(e),n=K(t.filter(y=>y.type!=="WHITESPACE"),0);return{compiled:H(n)}}catch(t){if(t instanceof Q)return{error:`Error: ${t.message}
    ${e}
    ${" ".repeat(t.index)}^`,errorRaw:t};throw t}};function Ee(e,t,n){const l=e.slice();return l[17]=t[n],l[18]=t,l[19]=n,l}function ge(e){let t,n,l,y,o,i,E,g,a,O,b,N=e[17].h.error+"",I,_,p,m,h,d,z,r,c=e[17].s.error+"",P,D,C,M,S,f,Z,j,Y=e[17].v.error+"",X,q,G,$,ee,oe;function we(){e[5].call(l,e[18],e[19])}function ye(){e[6].call(a,e[18],e[19])}function Re(){e[7].call(d,e[18],e[19])}function Oe(){e[8].call(f,e[18],e[19])}function Te(){return e[9](e[17])}function Ve(){e[10].call(t,e[18],e[19])}function Ie(){return e[11](e[17],e[18],e[19])}return{c(){t=v("details"),n=v("summary"),l=v("input"),y=x(),o=v("div"),i=v("div"),E=v("label"),g=U("h = "),a=v("input"),O=x(),b=v("pre"),I=U(N),_=x(),p=v("div"),m=v("label"),h=U("s = "),d=v("input"),z=x(),r=v("pre"),P=U(c),D=x(),C=v("div"),M=v("label"),S=U("v = "),f=v("input"),Z=x(),j=v("pre"),X=U(Y),q=x(),G=v("button"),$=U("Delete"),this.h()},l(F){t=A(F,"DETAILS",{class:!0});var T=R(t);n=A(T,"SUMMARY",{});var se=R(n);l=A(se,"INPUT",{type:!0,class:!0}),se.forEach(w),y=B(T),o=A(T,"DIV",{class:!0});var V=R(o);i=A(V,"DIV",{class:!0});var te=R(i);E=A(te,"LABEL",{for:!0});var ue=R(E);g=k(ue,"h = "),ue.forEach(w),a=A(te,"INPUT",{name:!0,class:!0,type:!0,autocomplete:!0,autocorrect:!0,autocapitalize:!0,spellcheck:!0}),te.forEach(w),O=B(V),b=A(V,"PRE",{});var ie=R(b);I=k(ie,N),ie.forEach(w),_=B(V),p=A(V,"DIV",{class:!0});var re=R(p);m=A(re,"LABEL",{for:!0});var pe=R(m);h=k(pe,"s = "),pe.forEach(w),d=A(re,"INPUT",{name:!0,class:!0,type:!0,autocomplete:!0,autocorrect:!0,autocapitalize:!0,spellcheck:!0}),re.forEach(w),z=B(V),r=A(V,"PRE",{});var ce=R(r);P=k(ce,c),ce.forEach(w),D=B(V),C=A(V,"DIV",{class:!0});var ne=R(C);M=A(ne,"LABEL",{for:!0});var fe=R(M);S=k(fe,"v = "),fe.forEach(w),f=A(ne,"INPUT",{name:!0,class:!0,type:!0,autocomplete:!0,autocorrect:!0,autocapitalize:!0,spellcheck:!0}),ne.forEach(w),Z=B(V),j=A(V,"PRE",{});var he=R(j);X=k(he,Y),he.forEach(w),q=B(V),G=A(V,"BUTTON",{class:!0});var de=R(G);$=k(de,"Delete"),de.forEach(w),V.forEach(w),T.forEach(w),this.h()},h(){u(l,"type","text"),u(l,"class","focus:outline-none font-mono"),u(E,"for","h"),u(a,"name","h"),u(a,"class","pl-4 font-mono focus:outline-none"),u(a,"type","text"),u(a,"autocomplete","off"),u(a,"autocorrect","off"),u(a,"autocapitalize","off"),u(a,"spellcheck","false"),u(i,"class","flex whitespace-nowrap"),u(m,"for","s"),u(d,"name","s"),u(d,"class","pl-4 font-mono focus:outline-none"),u(d,"type","text"),u(d,"autocomplete","off"),u(d,"autocorrect","off"),u(d,"autocapitalize","off"),u(d,"spellcheck","false"),u(p,"class","flex whitespace-nowrap"),u(M,"for","v"),u(f,"name","v"),u(f,"class","pl-4 font-mono focus:outline-none"),u(f,"type","text"),u(f,"autocomplete","off"),u(f,"autocorrect","off"),u(f,"autocapitalize","off"),u(f,"spellcheck","false"),u(C,"class","flex whitespace-nowrap"),u(G,"class","mt-4"),u(o,"class","pl-10"),u(t,"class","pl-10 py-5 font-mono text-xl")},m(F,T){ve(F,t,T),s(t,n),s(n,l),W(l,e[17].name),s(t,y),s(t,o),s(o,i),s(i,E),s(E,g),s(i,a),W(a,e[17].h.value),s(o,O),s(o,b),s(b,I),s(o,_),s(o,p),s(p,m),s(m,h),s(p,d),W(d,e[17].s.value),s(o,z),s(o,r),s(r,P),s(o,D),s(o,C),s(C,M),s(M,S),s(C,f),W(f,e[17].v.value),s(o,Z),s(o,j),s(j,X),s(o,q),s(o,G),s(G,$),t.open=e[17].open,ee||(oe=[L(l,"input",we),L(a,"input",ye),L(a,"input",function(){le(e[17].h.onChange)&&e[17].h.onChange.apply(this,arguments)}),L(d,"input",Re),L(d,"input",function(){le(e[17].s.onChange)&&e[17].s.onChange.apply(this,arguments)}),L(f,"input",Oe),L(f,"input",function(){le(e[17].v.onChange)&&e[17].v.onChange.apply(this,arguments)}),L(G,"click",Te),L(t,"toggle",Ve),L(t,"click",Ie)],ee=!0)},p(F,T){e=F,T&1&&l.value!==e[17].name&&W(l,e[17].name),T&1&&a.value!==e[17].h.value&&W(a,e[17].h.value),T&1&&N!==(N=e[17].h.error+"")&&ae(I,N),T&1&&d.value!==e[17].s.value&&W(d,e[17].s.value),T&1&&c!==(c=e[17].s.error+"")&&ae(P,c),T&1&&f.value!==e[17].v.value&&W(f,e[17].v.value),T&1&&Y!==(Y=e[17].v.error+"")&&ae(X,Y),T&1&&(t.open=e[17].open)},d(F){F&&w(t),ee=!1,Ae(oe)}}}function xe(e){let t,n,l,y,o,i,E,g,a,O,b,N,I=e[0],_=[];for(let p=0;p<I.length;p+=1)_[p]=ge(Ee(e,I,p));return{c(){t=v("div"),n=v("h1"),l=U("LEDS"),y=x();for(let p=0;p<_.length;p+=1)_[p].c();o=x(),i=v("button"),E=U("Add equation"),g=x(),a=v("button"),O=U("Reload"),this.h()},l(p){t=A(p,"DIV",{class:!0});var m=R(t);n=A(m,"H1",{class:!0});var h=R(n);l=k(h,"LEDS"),h.forEach(w),y=B(m);for(let r=0;r<_.length;r+=1)_[r].l(m);o=B(m),i=A(m,"BUTTON",{class:!0});var d=R(i);E=k(d,"Add equation"),d.forEach(w),g=B(m),a=A(m,"BUTTON",{class:!0});var z=R(a);O=k(z,"Reload"),z.forEach(w),m.forEach(w),this.h()},h(){u(n,"class","text-5xl"),u(i,"class","text-2xl"),u(a,"class","text-2xl mt-6"),u(t,"class","p-4")},m(p,m){ve(p,t,m),s(t,n),s(n,l),s(t,y);for(let h=0;h<_.length;h+=1)_[h].m(t,null);s(t,o),s(t,i),s(i,E),s(t,g),s(t,a),s(a,O),b||(N=[L(i,"click",e[2]),L(a,"click",e[12])],b=!0)},p(p,[m]){if(m&11){I=p[0];let h;for(h=0;h<I.length;h+=1){const d=Ee(p,I,h);_[h]?_[h].p(d,m):(_[h]=ge(d),_[h].c(),_[h].m(t,o))}for(;h<_.length;h+=1)_[h].d(1);_.length=I.length}},i:_e,o:_e,d(p){p&&w(t),Ne(_,p),b=!1,Ae(N)}}}function ke(e,t,n){let l=[],y=!1,o=!1;De(()=>{window.location.protocol==="https:"&&(window.location.protocol="http:"),n(0,l=JSON.parse(localStorage.getItem("equations")||"[]")),l.forEach(r=>{r.h.onChange=a(r.h,r),r.s.onChange=a(r.s,r),r.v.onChange=a(r.v,r),r.h.onChange(),r.s.onChange(),r.v.onChange()}),o=!0,n(4,y=!0)});let i=!1,E;const g=(r,c=!0)=>{if(!o||r.h.error||r.s.error||r.v.error)return;i&&(E&&clearInterval(E),E=setInterval(()=>{i||(g(r,c),clearInterval(E))},1));const P=new Uint32Array(r.h.compiledValue),D=new Uint32Array(r.s.compiledValue),C=new Uint32Array(r.v.compiledValue),M=new Uint32Array([+c]),S=new Uint32Array([J.END,0]),f=new WebSocket("ws://home.anb.codes:13655");i=!0,f.addEventListener("open",()=>{console.log("Sending..."),f.send(M.buffer),console.log(M),f.send(P.buffer),console.log(P),f.send(S.buffer),console.log(S),f.send(D.buffer),console.log(D),f.send(S.buffer),console.log(S),f.send(C.buffer),console.log(C),f.send(S.buffer),console.log(S)}),f.addEventListener("close",()=>{i=!1,console.log("closed")})},a=(r,c)=>()=>{const P=Ue(r.value);P.error?r.error=P.error:(r.error="",r.compiledValue=P.compiled),g(c),n(0,l)},O=()=>{const r={h:{value:"",compiledValue:[],onChange:()=>{},error:""},s:{value:"",compiledValue:[],onChange:()=>{},error:""},v:{value:"",compiledValue:[],onChange:()=>{},error:""},name:"New Equation",open:!0};r.h.onChange=a(r.h,r),r.s.onChange=a(r.s,r),r.v.onChange=a(r.v,r),r.h.onChange(),r.s.onChange(),r.v.onChange(),l.forEach(c=>c.open=!1),l.push(r),n(0,l)},b=r=>{n(0,l=l.filter(c=>c!==r))};function N(r,c){r[c].name=this.value,n(0,l)}function I(r,c){r[c].h.value=this.value,n(0,l)}function _(r,c){r[c].s.value=this.value,n(0,l)}function p(r,c){r[c].v.value=this.value,n(0,l)}const m=r=>b(r);function h(r,c){r[c].open=this.open,n(0,l)}const d=(r,c,P)=>{console.log(l),r.open||(g(r),l.filter(D=>D!==r).forEach(D=>D.open=!1),setTimeout(()=>n(0,c[P].open=!0,l),0),n(0,l))},z=()=>location.reload();return e.$$.update=()=>{e.$$.dirty&17&&y&&localStorage.setItem("equations",JSON.stringify(l))},[l,g,O,b,y,N,I,_,p,m,h,d,z]}class Me extends Pe{constructor(t){super(),be(this,t,ke,xe,Le,{})}}export{Me as default};
