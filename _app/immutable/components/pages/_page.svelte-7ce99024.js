import{S as De,i as Ne,s as Se,k as g,q as k,a as z,l as m,m as w,r as B,h as v,c as W,n as c,b as Ee,G as o,I as P,B as de,J as xe,K as ve,o as Ce,L as H,u as ae}from"../../chunks/index-1461500f.js";const j={INVALID:0,SIN:1,ADD:2,SUB:3,MUL:4,DIV:5,POW:6,MOD:7,IF:8,EQ:9,GT:10,LT:11,AND:12,OR:13,VAL:14,VAR_T:15,VAR_I:16,END:17},Ue=j,Me=e=>e.split("").map((t,n)=>t==="("?{type:"OPEN_PARAN",rawValue:t,index:n}:t===")"?{type:"CLOSE_PARAN",rawValue:t,index:n}:t===" "?{type:"WHITESPACE",rawValue:t,index:n}:t==="+"?{type:"OPERATOR",operator:"ADD",rawValue:t,index:n}:t==="-"?{type:"OPERATOR",operator:"SUB",rawValue:t,index:n}:t==="*"?{type:"OPERATOR",operator:"MUL",rawValue:t,index:n}:t==="/"?{type:"OPERATOR",operator:"DIV",rawValue:t,index:n}:t==="%"?{type:"OPERATOR",operator:"MOD",rawValue:t,index:n}:t==="^"?{type:"OPERATOR",operator:"POW",rawValue:t,index:n}:t===">"?{type:"OPERATOR",operator:"GT",rawValue:t,index:n}:t==="<"?{type:"OPERATOR",operator:"LT",rawValue:t,index:n}:t==="="?{type:"OPERATOR",operator:"EQ",rawValue:t,index:n}:t===","?{type:"OPERATOR",operator:"SEP",rawValue:t,index:n}:t==="&"?{type:"OPERATOR",operator:"AND",rawValue:t,index:n}:t==="|"?{type:"OPERATOR",operator:"OR",rawValue:t,index:n}:{type:"LITERAL",value:t,rawValue:t,index:n}),_e=[["SEP"],["AND","OR"],["GT","LT","EQ"],["MOD"],["ADD","SUB"],["DIV","MUL"]];class Y extends Error{constructor(t,n){super(t),this.index=n}}const Z=(e,t)=>{if(e.length===0)throw new Y("Expected an expression",t);for(let l=0;l<_e.length;l++){const p=_e[l];let d=0;for(let E=0;E<e.length;E++){const s=e[E];if(s.type==="OPEN_PARAN"&&(d+=1),s.type==="CLOSE_PARAN"&&(d-=1),s.type==="OPERATOR"&&d==0&&p.includes(s.operator))return{type:"operator",op:s.operator,a:Z(e.slice(0,E),e[0].index+1),b:Z(e.slice(E+1),s.index+1),index:s.index}}}let n="",a=-1;for(let l=0;l<e.length;l++){const p=e[l];if(p.type==="LITERAL"&&(n+=p.value,a===-1&&(a=p.index)),p.type==="OPEN_PARAN"){if(e.slice(-1)[0].type!=="CLOSE_PARAN")throw new Y("Unmatched opening parenthesis",p.index);if(n){const d=Z(e.slice(l+1,-1),p.index),E=[],s=y=>{y.type==="operator"&&y.op==="SEP"?(s(y.a),s(y.b)):E.push(y)};return s(d),{type:"call",name:n,args:E,index:a}}else return Z(e.slice(l+1,-1),p.index)}}const A=e.find(l=>l.type!=="LITERAL");if(A)throw new Y(`Unexpected token: ${A.rawValue}`,A.index);return n=e.map(l=>l.value).join(""),isNaN(parseInt(n,10))?{type:"variable",name:n,index:e[0].index}:{type:"value",val:parseInt(n,10),index:e[0].index}},Q=e=>{if(e.type==="call"){if(e.name==="if")return[...Q(e.args[0]),...Q(e.args[1]),...Q(e.args[2]),j.IF];if(e.name==="sin")return[...Q(e.args[0]),j.SIN];throw new Y(`Invalid function: ${e.name}`,e.index)}else if(e.type==="operator"){const t=Ue[e.op];if(t===void 0)throw new Y(`Invalid operator: ${e.op}`,e.index);return[...Q(e.a),...Q(e.b),t]}else{if(e.type==="value")return[j.VAL,e.val];if(e.type==="variable"){if(e.name==="i")return[j.VAR_I];if(e.name==="t")return[j.VAR_T];throw new Y(`Unknown variable: ${e.name}`,e.index)}else throw new Error("INVALID TYPE")}},ke=e=>{try{const t=Me(e),n=Z(t.filter(A=>A.type!=="WHITESPACE"),0);return{compiled:Q(n)}}catch(t){if(t instanceof Y)return{error:`Error: ${t.message}
    ${e}
    ${" ".repeat(t.index)}^`,errorRaw:t};throw t}};function ge(e,t,n){const a=e.slice();return a[21]=t[n],a[22]=t,a[23]=n,a}function me(e){let t,n,a,A,l,p,d,E,s,y,L,x=e[21].h.error+"",G,D,h,f,b,i,I,C,U=e[21].s.error+"",M,X,r,u,N,_,K,F,S=e[21].v.error+"",T,$,J,q,ee,le;function ye(){e[5].call(a,e[22],e[23])}function we(...R){return e[6](e[21],...R)}function Ae(){e[7].call(s,e[22],e[23])}function be(...R){return e[8](e[21],...R)}function Re(){e[9].call(i,e[22],e[23])}function Oe(...R){return e[10](e[21],...R)}function Te(){e[11].call(_,e[22],e[23])}function Ve(...R){return e[12](e[21],...R)}function Ie(){return e[13](e[21])}function Pe(){e[14].call(t,e[22],e[23])}function Le(){return e[15](e[21],e[22],e[23])}return{c(){t=g("details"),n=g("summary"),a=g("input"),A=z(),l=g("div"),p=g("div"),d=g("label"),E=k("h = "),s=g("input"),y=z(),L=g("pre"),G=k(x),D=z(),h=g("div"),f=g("label"),b=k("s = "),i=g("input"),I=z(),C=g("pre"),M=k(U),X=z(),r=g("div"),u=g("label"),N=k("v = "),_=g("input"),K=z(),F=g("pre"),T=k(S),$=z(),J=g("button"),q=k("Delete"),this.h()},l(R){t=m(R,"DETAILS",{class:!0});var O=w(t);n=m(O,"SUMMARY",{});var oe=w(n);a=m(oe,"INPUT",{type:!0,class:!0}),oe.forEach(v),A=W(O),l=m(O,"DIV",{class:!0});var V=w(l);p=m(V,"DIV",{class:!0});var te=w(p);d=m(te,"LABEL",{for:!0});var se=w(d);E=B(se,"h = "),se.forEach(v),s=m(te,"INPUT",{name:!0,class:!0,type:!0,autocomplete:!0,autocorrect:!0,autocapitalize:!0,spellcheck:!0}),te.forEach(v),y=W(V),L=m(V,"PRE",{});var ue=w(L);G=B(ue,x),ue.forEach(v),D=W(V),h=m(V,"DIV",{class:!0});var re=w(h);f=m(re,"LABEL",{for:!0});var ie=w(f);b=B(ie,"s = "),ie.forEach(v),i=m(re,"INPUT",{name:!0,class:!0,type:!0,autocomplete:!0,autocorrect:!0,autocapitalize:!0,spellcheck:!0}),re.forEach(v),I=W(V),C=m(V,"PRE",{});var ce=w(C);M=B(ce,U),ce.forEach(v),X=W(V),r=m(V,"DIV",{class:!0});var ne=w(r);u=m(ne,"LABEL",{for:!0});var pe=w(u);N=B(pe,"v = "),pe.forEach(v),_=m(ne,"INPUT",{name:!0,class:!0,type:!0,autocomplete:!0,autocorrect:!0,autocapitalize:!0,spellcheck:!0}),ne.forEach(v),K=W(V),F=m(V,"PRE",{});var fe=w(F);T=B(fe,S),fe.forEach(v),$=W(V),J=m(V,"BUTTON",{class:!0});var he=w(J);q=B(he,"Delete"),he.forEach(v),V.forEach(v),O.forEach(v),this.h()},h(){c(a,"type","text"),c(a,"class","focus:outline-none text-2xl font-mono resize-x"),c(d,"for","h"),c(s,"name","h"),c(s,"class","pl-4 font-mono focus:outline-none resize-x"),c(s,"type","text"),c(s,"autocomplete","off"),c(s,"autocorrect","off"),c(s,"autocapitalize","off"),c(s,"spellcheck","false"),c(p,"class","flex whitespace-nowrap"),c(f,"for","s"),c(i,"name","s"),c(i,"class","pl-4 font-mono focus:outline-none resize-x"),c(i,"type","text"),c(i,"autocomplete","off"),c(i,"autocorrect","off"),c(i,"autocapitalize","off"),c(i,"spellcheck","false"),c(h,"class","flex whitespace-nowrap"),c(u,"for","v"),c(_,"name","v"),c(_,"class","pl-4 font-mono focus:outline-none resize-x"),c(_,"type","text"),c(_,"autocomplete","off"),c(_,"autocorrect","off"),c(_,"autocapitalize","off"),c(_,"spellcheck","false"),c(r,"class","flex whitespace-nowrap"),c(J,"class","mt-4 text-2xl font-sans rounded border-gray-800 border-solid border w-48 py-4 hover:bg-gray-200 active:bg-gray-300"),c(l,"class","pl-10"),c(t,"class","pl-10 py-5 font-mono text-xl")},m(R,O){Ee(R,t,O),o(t,n),o(n,a),H(a,e[21].name),o(t,A),o(t,l),o(l,p),o(p,d),o(d,E),o(p,s),H(s,e[21].h.value),o(l,y),o(l,L),o(L,G),o(l,D),o(l,h),o(h,f),o(f,b),o(h,i),H(i,e[21].s.value),o(l,I),o(l,C),o(C,M),o(l,X),o(l,r),o(r,u),o(u,N),o(r,_),H(_,e[21].v.value),o(l,K),o(l,F),o(F,T),o(l,$),o(l,J),o(J,q),t.open=e[21].open,ee||(le=[P(a,"input",ye),P(a,"input",we),P(s,"input",Ae),P(s,"input",be),P(i,"input",Re),P(i,"input",Oe),P(_,"input",Te),P(_,"input",Ve),P(J,"click",Ie),P(t,"toggle",Pe),P(t,"click",Le)],ee=!0)},p(R,O){e=R,O&1&&a.value!==e[21].name&&H(a,e[21].name),O&1&&s.value!==e[21].h.value&&H(s,e[21].h.value),O&1&&x!==(x=e[21].h.error+"")&&ae(G,x),O&1&&i.value!==e[21].s.value&&H(i,e[21].s.value),O&1&&U!==(U=e[21].s.error+"")&&ae(M,U),O&1&&_.value!==e[21].v.value&&H(_,e[21].v.value),O&1&&S!==(S=e[21].v.error+"")&&ae(T,S),O&1&&(t.open=e[21].open)},d(R){R&&v(t),ee=!1,ve(le)}}}function ze(e){let t,n,a,A,l,p,d,E,s,y,L,x,G,D=e[0],h=[];for(let f=0;f<D.length;f+=1)h[f]=me(ge(e,D,f));return{c(){t=g("div"),n=g("h1"),a=k("LEDS"),A=z();for(let f=0;f<h.length;f+=1)h[f].c();l=z(),p=g("div"),d=g("button"),E=k("Add equation"),s=z(),y=g("button"),L=k("Reload"),this.h()},l(f){t=m(f,"DIV",{class:!0});var b=w(t);n=m(b,"H1",{class:!0});var i=w(n);a=B(i,"LEDS"),i.forEach(v),A=W(b);for(let M=0;M<h.length;M+=1)h[M].l(b);l=W(b),p=m(b,"DIV",{class:!0});var I=w(p);d=m(I,"BUTTON",{class:!0});var C=w(d);E=B(C,"Add equation"),C.forEach(v),s=W(I),y=m(I,"BUTTON",{class:!0});var U=w(y);L=B(U,"Reload"),U.forEach(v),I.forEach(v),b.forEach(v),this.h()},h(){c(n,"class","text-5xl"),c(d,"class","text-2xl mt-14 rounded border-gray-800 border-solid border w-48 py-4 hover:bg-gray-200 active:bg-gray-300"),c(y,"class","text-2xl mt-14 rounded border-gray-800 border-solid border w-48 py-4 hover:bg-gray-200 active:bg-gray-300"),c(p,"class","flex flex-col"),c(t,"class","p-4 font-sans")},m(f,b){Ee(f,t,b),o(t,n),o(n,a),o(t,A);for(let i=0;i<h.length;i+=1)h[i].m(t,null);o(t,l),o(t,p),o(p,d),o(d,E),o(p,s),o(p,y),o(y,L),x||(G=[P(d,"click",e[2]),P(y,"click",e[16])],x=!0)},p(f,[b]){if(b&11){D=f[0];let i;for(i=0;i<D.length;i+=1){const I=ge(f,D,i);h[i]?h[i].p(I,b):(h[i]=me(I),h[i].c(),h[i].m(t,l))}for(;i<h.length;i+=1)h[i].d(1);h.length=D.length}},i:de,o:de,d(f){f&&v(t),xe(h,f),x=!1,ve(G)}}}function Be(e,t,n){let a=[],A=!1,l=!1;Ce(()=>{window.location.protocol==="https:"&&(window.location.protocol="http:"),n(0,a=JSON.parse(localStorage.getItem("equations")||"[]")),a.forEach(r=>{r.h.onChange=s(r.h,r),r.s.onChange=s(r.s,r),r.v.onChange=s(r.v,r),r.h.onChange(),r.s.onChange(),r.v.onChange()}),l=!0,n(4,A=!0),setTimeout(()=>{document.querySelectorAll("input").forEach(r=>{r.style.width=Math.max(r.value.length+5,10)+"ch"})})});let p=!1,d;const E=(r,u=!0)=>{if(!l||r.h.error||r.s.error||r.v.error)return;p&&(d&&clearInterval(d),d=setInterval(()=>{p||(E(r,u),clearInterval(d))},1));const N=new Uint32Array(r.h.compiledValue),_=new Uint32Array(r.s.compiledValue),K=new Uint32Array(r.v.compiledValue),F=new Uint32Array([+u]),S=new Uint32Array([j.END,0]),T=new WebSocket("ws://home.anb.codes:13655");p=!0,T.addEventListener("open",()=>{console.log("Sending..."),T.send(F.buffer),console.log(F),T.send(N.buffer),console.log(N),T.send(S.buffer),console.log(S),T.send(_.buffer),console.log(_),T.send(S.buffer),console.log(S),T.send(K.buffer),console.log(K),T.send(S.buffer),console.log(S)}),T.addEventListener("close",()=>{p=!1,console.log("closed")})},s=(r,u)=>()=>{const N=ke(r.value);N.error?r.error=N.error:(r.error="",r.compiledValue=N.compiled),E(u),n(0,a)},y=()=>{const r={h:{value:"",compiledValue:[],onChange:()=>{},error:""},s:{value:"",compiledValue:[],onChange:()=>{},error:""},v:{value:"",compiledValue:[],onChange:()=>{},error:""},name:"New Equation",open:!0};r.h.onChange=s(r.h,r),r.s.onChange=s(r.s,r),r.v.onChange=s(r.v,r),r.h.onChange(),r.s.onChange(),r.v.onChange(),a.forEach(u=>u.open=!1),a.push(r),n(0,a)},L=r=>{n(0,a=a.filter(u=>u!==r))};function x(r,u){r[u].name=this.value,n(0,a)}const G=(r,u)=>{u.target&&(u.target.style.width=Math.max(r.s.value.length+5,10)+"ch"),r.s.onChange()};function D(r,u){r[u].h.value=this.value,n(0,a)}const h=(r,u)=>{u.target&&(u.target.style.width=Math.max(r.h.value.length+5,10)+"ch"),r.h.onChange()};function f(r,u){r[u].s.value=this.value,n(0,a)}const b=(r,u)=>{u.target&&(u.target.style.width=Math.max(r.s.value.length+5,10)+"ch"),r.s.onChange()};function i(r,u){r[u].v.value=this.value,n(0,a)}const I=(r,u)=>{u.target&&(u.target.style.width=Math.max(r.v.value.length+5,10)+"ch"),r.v.onChange()},C=r=>L(r);function U(r,u){r[u].open=this.open,n(0,a)}const M=(r,u,N)=>{console.log(a),r.open||(E(r),a.filter(_=>_!==r).forEach(_=>_.open=!1),setTimeout(()=>n(0,u[N].open=!0,a),0),n(0,a))},X=()=>location.reload();return e.$$.update=()=>{e.$$.dirty&17&&A&&localStorage.setItem("equations",JSON.stringify(a))},[a,E,y,L,A,x,G,D,h,f,b,i,I,C,U,M,X]}class Ge extends De{constructor(t){super(),Ne(this,t,Be,ze,Se,{})}}export{Ge as default};
