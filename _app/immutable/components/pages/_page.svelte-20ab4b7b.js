import{S as Fe,i as Je,s as Qe,k as h,q as I,a as C,l as b,m,r as P,h as c,c as L,n,I as X,b as U,G as o,J as B,B as be,K as Ke,L as De,o as Ye,u as $,M as Y,N as Pe}from"../../chunks/index-f6eecf18.js";const re={INVALID:0,SIN:1,ADD:2,SUB:3,MUL:4,DIV:5,POW:6,MOD:7,IF:8,EQ:9,GT:10,LT:11,AND:12,OR:13,VAL:14,VAR_T:15,VAR_I:16,END:17},Xe=re,Ze=e=>e.split("").map((r,t)=>r==="("?{type:"OPEN_PARAN",rawValue:r,index:t}:r===")"?{type:"CLOSE_PARAN",rawValue:r,index:t}:r===" "?{type:"WHITESPACE",rawValue:r,index:t}:r==="+"?{type:"OPERATOR",operator:"ADD",rawValue:r,index:t}:r==="-"?{type:"OPERATOR",operator:"SUB",rawValue:r,index:t}:r==="*"?{type:"OPERATOR",operator:"MUL",rawValue:r,index:t}:r==="/"?{type:"OPERATOR",operator:"DIV",rawValue:r,index:t}:r==="%"?{type:"OPERATOR",operator:"MOD",rawValue:r,index:t}:r==="^"?{type:"OPERATOR",operator:"POW",rawValue:r,index:t}:r===">"?{type:"OPERATOR",operator:"GT",rawValue:r,index:t}:r==="<"?{type:"OPERATOR",operator:"LT",rawValue:r,index:t}:r==="="?{type:"OPERATOR",operator:"EQ",rawValue:r,index:t}:r===","?{type:"OPERATOR",operator:"SEP",rawValue:r,index:t}:r==="&"?{type:"OPERATOR",operator:"AND",rawValue:r,index:t}:r==="|"?{type:"OPERATOR",operator:"OR",rawValue:r,index:t}:{type:"LITERAL",value:r,rawValue:r,index:t}),We=[["SEP"],["AND","OR"],["GT","LT","EQ"],["MOD"],["ADD","SUB"],["DIV","MUL"]];class te extends Error{constructor(r,t){super(r),this.index=t}}const ie=(e,r)=>{if(e.length===0)throw new te("Expected an expression",r);for(let s=0;s<We.length;s++){const i=We[s];let v=0;for(let u=0;u<e.length;u++){const l=e[u];if(l.type==="OPEN_PARAN"&&(v+=1),l.type==="CLOSE_PARAN"&&(v-=1),l.type==="OPERATOR"&&v==0&&i.includes(l.operator))return{type:"operator",op:l.operator,a:ie(e.slice(0,u),e[0].index+1),b:ie(e.slice(u+1),l.index+1),index:l.index}}}let t="",p=-1;for(let s=0;s<e.length;s++){const i=e[s];if(i.type==="LITERAL"&&(t+=i.value,p===-1&&(p=i.index)),i.type==="OPEN_PARAN"){if(e.slice(-1)[0].type!=="CLOSE_PARAN")throw new te("Unmatched opening parenthesis",i.index);if(t){const v=ie(e.slice(s+1,-1),i.index),u=[],l=g=>{g.type==="operator"&&g.op==="SEP"?(l(g.a),l(g.b)):u.push(g)};return l(v),{type:"call",name:t,args:u,index:p}}else return ie(e.slice(s+1,-1),i.index)}}const d=e.find(s=>s.type!=="LITERAL");if(d)throw new te(`Unexpected token: ${d.rawValue}`,d.index);return t=e.map(s=>s.value).join(""),isNaN(parseInt(t,10))?{type:"variable",name:t,index:e[0].index}:{type:"value",val:parseInt(t,10),index:e[0].index}},ee=e=>{if(e.type==="call"){if(e.name==="if")return[...ee(e.args[0]),...ee(e.args[1]),...ee(e.args[2]),re.IF];if(e.name==="sin")return[...ee(e.args[0]),re.SIN];throw new te(`Invalid function: ${e.name}`,e.index)}else if(e.type==="operator"){const r=Xe[e.op];if(r===void 0)throw new te(`Invalid operator: ${e.op}`,e.index);return[...ee(e.a),...ee(e.b),r]}else{if(e.type==="value")return[re.VAL,e.val];if(e.type==="variable"){if(e.name==="i")return[re.VAR_I];if(e.name==="t")return[re.VAR_T];throw new te(`Unknown variable: ${e.name}`,e.index)}else throw new Error("INVALID TYPE")}},qe=e=>{try{const r=Ze(e),t=ie(r.filter(d=>d.type!=="WHITESPACE"),0);return{compiled:ee(t)}}catch(r){if(r instanceof te)return{error:`Error: ${r.message}
    ${e}
    ${" ".repeat(r.index)}^`,errorRaw:r};throw r}};function Ge(e,r,t){const p=e.slice();return p[21]=r[t],p[23]=t,p}function He(e){let r,t=e[21].name+"",p,d,s,i;function v(){return e[7](e[21])}return{c(){r=h("button"),p=I(t),this.h()},l(u){r=b(u,"BUTTON",{class:!0});var l=m(r);p=P(l,t),l.forEach(c),this.h()},h(){n(r,"class",d="border-gray-800 p-2 mx-2 border-solid border-b "+(e[21]===e[1]?"":"hover:bg-gray-200")+" active:bg-gray-300"),X(r,"bg-gray-300",e[21]===e[1]),X(r,"border-t",e[23]===0)},m(u,l){U(u,r,l),o(r,p),s||(i=B(r,"click",v),s=!0)},p(u,l){e=u,l&1&&t!==(t=e[21].name+"")&&$(p,t),l&3&&d!==(d="border-gray-800 p-2 mx-2 border-solid border-b "+(e[21]===e[1]?"":"hover:bg-gray-200")+" active:bg-gray-300")&&n(r,"class",d),l&3&&X(r,"bg-gray-300",e[21]===e[1]),l&3&&X(r,"border-t",e[23]===0)},d(u){u&&c(r),s=!1,i()}}}function je(e){let r,t,p,d,s,i,v,u,l,g,N,j,_,M,z,Q,J=e[1].h.value+"",W,A,y,f=e[1].h.error+"",O,E,a,V,G,R,K,H,x,k=e[1].s.value+"",fe,ve,ae,oe=e[1].s.error+"",ce,_e,Z,le,me,S,ge,ne,se=e[1].v.error+"",pe,Ee,q,ye,ue=e[1].v.value+"",de,we,Ne;function Ce(T,w){return T[2]?er:$e}let he=Ce(e),F=he(e);return{c(){r=h("div"),t=h("button"),p=I("Back"),d=C(),s=h("div"),F.c(),i=C(),v=h("input"),u=C(),l=h("div"),g=h("div"),N=h("label"),j=I("h = "),_=h("input"),M=C(),z=h("pre"),Q=I("    "),W=I(J),A=C(),y=h("pre"),O=I(f),E=C(),a=h("div"),V=h("label"),G=I("s = "),R=h("input"),K=C(),H=h("pre"),x=I("    "),fe=I(k),ve=C(),ae=h("pre"),ce=I(oe),_e=C(),Z=h("div"),le=h("label"),me=I("v = "),S=h("input"),ge=C(),ne=h("pre"),pe=I(se),Ee=C(),q=h("pre"),ye=I("    "),de=I(ue),this.h()},l(T){r=b(T,"DIV",{class:!0});var w=m(r);t=b(w,"BUTTON",{class:!0});var Le=m(t);p=P(Le,"Back"),Le.forEach(c),d=L(w),s=b(w,"DIV",{class:!0});var ke=m(s);F.l(ke),ke.forEach(c),w.forEach(c),i=L(T),v=b(T,"INPUT",{type:!0,class:!0}),u=L(T),l=b(T,"DIV",{class:!0});var D=m(l);g=b(D,"DIV",{class:!0});var Ae=m(g);N=b(Ae,"LABEL",{for:!0});var Se=m(N);j=P(Se,"h = "),Se.forEach(c),_=b(Ae,"INPUT",{name:!0,class:!0,type:!0,autocomplete:!0,autocorrect:!0,autocapitalize:!0,spellcheck:!0}),Ae.forEach(c),M=L(D),z=b(D,"PRE",{class:!0});var Oe=m(z);Q=P(Oe,"    "),W=P(Oe,J),Oe.forEach(c),A=L(D),y=b(D,"PRE",{});var Ue=m(y);O=P(Ue,f),Ue.forEach(c),E=L(D),a=b(D,"DIV",{class:!0});var Re=m(a);V=b(Re,"LABEL",{for:!0});var xe=m(V);G=P(xe,"s = "),xe.forEach(c),R=b(Re,"INPUT",{name:!0,class:!0,type:!0,autocomplete:!0,autocorrect:!0,autocapitalize:!0,spellcheck:!0}),Re.forEach(c),K=L(D),H=b(D,"PRE",{class:!0});var Te=m(H);x=P(Te,"    "),fe=P(Te,k),Te.forEach(c),ve=L(D),ae=b(D,"PRE",{});var Be=m(ae);ce=P(Be,oe),Be.forEach(c),_e=L(D),Z=b(D,"DIV",{class:!0});var Ve=m(Z);le=b(Ve,"LABEL",{for:!0});var Me=m(le);me=P(Me,"v = "),Me.forEach(c),S=b(Ve,"INPUT",{name:!0,class:!0,type:!0,autocomplete:!0,autocorrect:!0,autocapitalize:!0,spellcheck:!0}),Ve.forEach(c),ge=L(D),ne=b(D,"PRE",{});var ze=m(ne);pe=P(ze,se),ze.forEach(c),Ee=L(D),q=b(D,"PRE",{class:!0});var Ie=m(q);ye=P(Ie,"    "),de=P(Ie,ue),Ie.forEach(c),D.forEach(c),this.h()},h(){n(t,"class","text-base md:hidden rounded border-gray-800 border-solid border py-1 px-3 mb-4 hover:bg-gray-200 active:bg-gray-300"),n(s,"class","flex md:flex-row-reverse"),n(r,"class","flex justify-between"),n(v,"type","text"),n(v,"class","focus:outline-none text-2xl w-full py-3"),n(N,"for","h"),n(_,"name","h"),n(_,"class","pl-4 font-mono focus:outline-none w-full"),n(_,"type","text"),n(_,"autocomplete","off"),n(_,"autocorrect","off"),n(_,"autocapitalize","off"),n(_,"spellcheck","false"),n(g,"class","flex whitespace-nowrap py-2"),n(z,"class","h-0 invisible"),n(V,"for","s"),n(R,"name","s"),n(R,"class","pl-4 font-mono focus:outline-none w-full"),n(R,"type","text"),n(R,"autocomplete","off"),n(R,"autocorrect","off"),n(R,"autocapitalize","off"),n(R,"spellcheck","false"),n(a,"class","flex whitespace-nowrap py-2"),n(H,"class","h-0 invisible"),n(le,"for","v"),n(S,"name","v"),n(S,"class","pl-4 font-mono focus:outline-none w-full"),n(S,"type","text"),n(S,"autocomplete","off"),n(S,"autocorrect","off"),n(S,"autocapitalize","off"),n(S,"spellcheck","false"),n(Z,"class","flex whitespace-nowrap py-2"),n(q,"class","h-0 invisible"),n(l,"class","pl-10")},m(T,w){U(T,r,w),o(r,t),o(t,p),o(r,d),o(r,s),F.m(s,null),U(T,i,w),U(T,v,w),Y(v,e[1].name),U(T,u,w),U(T,l,w),o(l,g),o(g,N),o(N,j),o(g,_),Y(_,e[1].h.value),o(l,M),o(l,z),o(z,Q),o(z,W),o(l,A),o(l,y),o(y,O),o(l,E),o(l,a),o(a,V),o(V,G),o(a,R),Y(R,e[1].s.value),o(l,K),o(l,H),o(H,x),o(H,fe),o(l,ve),o(l,ae),o(ae,ce),o(l,_e),o(l,Z),o(Z,le),o(le,me),o(Z,S),Y(S,e[1].v.value),o(l,ge),o(l,ne),o(ne,pe),o(l,Ee),o(l,q),o(q,ye),o(q,de),we||(Ne=[B(t,"click",e[8]),B(v,"input",e[12]),B(_,"input",e[13]),B(_,"input",function(){Pe(e[1].h.onChange)&&e[1].h.onChange.apply(this,arguments)}),B(R,"input",e[14]),B(R,"input",function(){Pe(e[1].s.onChange)&&e[1].s.onChange.apply(this,arguments)}),B(S,"input",e[15]),B(S,"input",function(){Pe(e[1].v.onChange)&&e[1].v.onChange.apply(this,arguments)})],we=!0)},p(T,w){e=T,he===(he=Ce(e))&&F?F.p(e,w):(F.d(1),F=he(e),F&&(F.c(),F.m(s,null))),w&2&&v.value!==e[1].name&&Y(v,e[1].name),w&2&&_.value!==e[1].h.value&&Y(_,e[1].h.value),w&2&&J!==(J=e[1].h.value+"")&&$(W,J),w&2&&f!==(f=e[1].h.error+"")&&$(O,f),w&2&&R.value!==e[1].s.value&&Y(R,e[1].s.value),w&2&&k!==(k=e[1].s.value+"")&&$(fe,k),w&2&&oe!==(oe=e[1].s.error+"")&&$(ce,oe),w&2&&S.value!==e[1].v.value&&Y(S,e[1].v.value),w&2&&se!==(se=e[1].v.error+"")&&$(pe,se),w&2&&ue!==(ue=e[1].v.value+"")&&$(de,ue)},d(T){T&&c(r),F.d(),T&&c(i),T&&c(v),T&&c(u),T&&c(l),we=!1,De(Ne)}}}function $e(e){let r,t,p,d;return{c(){r=h("button"),t=I("Delete"),this.h()},l(s){r=b(s,"BUTTON",{class:!0});var i=m(r);t=P(i,"Delete"),i.forEach(c),this.h()},h(){n(r,"class","text-base rounded border-gray-800 border-solid border py-1 px-3 mb-4 hover:bg-gray-200 active:bg-gray-300")},m(s,i){U(s,r,i),o(r,t),p||(d=B(r,"click",e[11]),p=!0)},p:be,d(s){s&&c(r),p=!1,d()}}}function er(e){let r,t,p,d,s,i,v;return{c(){r=h("button"),t=I("Confirm Delete"),p=C(),d=h("button"),s=I("Cancel Delete"),this.h()},l(u){r=b(u,"BUTTON",{class:!0});var l=m(r);t=P(l,"Confirm Delete"),l.forEach(c),p=L(u),d=b(u,"BUTTON",{class:!0});var g=m(d);s=P(g,"Cancel Delete"),g.forEach(c),this.h()},h(){n(r,"class","text-base rounded border-green-800 text-green-800 border-solid border py-1 px-3 mb-4 mx-2 hover:bg-gray-200 active:bg-gray-300"),n(d,"class","text-base rounded border-red-800 text-red-800 border-solid border py-1 px-3 mb-4 mx-2 hover:bg-gray-200 active:bg-gray-300")},m(u,l){U(u,r,l),o(r,t),U(u,p,l),U(u,d,l),o(d,s),i||(v=[B(r,"click",e[9]),B(d,"click",e[10])],i=!0)},p:be,d(u){u&&c(r),u&&c(p),u&&c(d),i=!1,De(v)}}}function rr(e){let r,t,p,d,s,i,v,u,l,g,N,j,_,M,z,Q,J,W=e[0],A=[];for(let f=0;f<W.length;f+=1)A[f]=He(Ge(e,W,f));let y=e[1]&&je(e);return{c(){r=h("header"),t=h("h1"),p=I("LEDS"),d=C(),s=h("div"),i=h("div");for(let f=0;f<A.length;f+=1)A[f].c();v=C(),u=h("button"),l=I("Add equation"),g=C(),N=h("div"),y&&y.c(),j=C(),_=h("div"),M=h("button"),z=I("Reload Page"),this.h()},l(f){r=b(f,"HEADER",{class:!0});var O=m(r);t=b(O,"H1",{class:!0});var E=m(t);p=P(E,"LEDS"),E.forEach(c),O.forEach(c),d=L(f),s=b(f,"DIV",{class:!0});var a=m(s);i=b(a,"DIV",{class:!0});var V=m(i);for(let x=0;x<A.length;x+=1)A[x].l(V);v=L(V),u=b(V,"BUTTON",{class:!0});var G=m(u);l=P(G,"Add equation"),G.forEach(c),V.forEach(c),g=L(a),N=b(a,"DIV",{class:!0});var R=m(N);y&&y.l(R),R.forEach(c),a.forEach(c),j=L(f),_=b(f,"DIV",{class:!0});var K=m(_);M=b(K,"BUTTON",{class:!0});var H=m(M);z=P(H,"Reload Page"),H.forEach(c),K.forEach(c),this.h()},h(){n(t,"class","text-5xl "),n(r,"class","pb-10 p-5"),n(u,"class","mt-14 rounded border-gray-800 border-solid border py-4 hover:bg-gray-200 active:bg-gray-300"),n(i,"class","md:flex flex-col flex-shrink-0 text-2xl w-full md:w-[300px] md:border-r border-gray-800 border-solid pr-4"),X(i,"hidden",e[1]),X(i,"flex",!e[1]),n(N,"class","pl-5 flex-grow"),n(s,"class","p-4 font-sans flex"),n(M,"class","text-1xl mt-20 rounded border-gray-800 border-solid border w-36 py-2 hover:bg-gray-200 active:bg-gray-300"),n(_,"class","p-4 flex flex-col")},m(f,O){U(f,r,O),o(r,t),o(t,p),U(f,d,O),U(f,s,O),o(s,i);for(let E=0;E<A.length;E+=1)A[E].m(i,null);o(i,v),o(i,u),o(u,l),o(s,g),o(s,N),y&&y.m(N,null),U(f,j,O),U(f,_,O),o(_,M),o(M,z),Q||(J=[B(u,"click",e[4]),B(M,"click",e[16])],Q=!0)},p(f,[O]){if(O&11){W=f[0];let E;for(E=0;E<W.length;E+=1){const a=Ge(f,W,E);A[E]?A[E].p(a,O):(A[E]=He(a),A[E].c(),A[E].m(i,v))}for(;E<A.length;E+=1)A[E].d(1);A.length=W.length}O&2&&X(i,"hidden",f[1]),O&2&&X(i,"flex",!f[1]),f[1]?y?y.p(f,O):(y=je(f),y.c(),y.m(N,null)):y&&(y.d(1),y=null)},i:be,o:be,d(f){f&&c(r),f&&c(d),f&&c(s),Ke(A,f),y&&y.d(),f&&c(j),f&&c(_),Q=!1,De(J)}}}function tr(e,r,t){let p=[],d=!1,s=!1;Ye(()=>{window.location.protocol==="https:"&&(window.location.protocol="http:"),t(0,p=JSON.parse(localStorage.getItem("equations")||"[]")),p.forEach(a=>{a.h.onChange=g(a.h,a),a.s.onChange=g(a.s,a),a.v.onChange=g(a.v,a),a.h.onChange(),a.s.onChange(),a.v.onChange()}),s=!0,t(6,d=!0),setTimeout(()=>{document.querySelectorAll("input").forEach(a=>{a.style.width=Math.max(a.value.length+5,10)+"ch"})})});let i=!1,v;const u=(a,V=!0)=>{if(!s||a.h.error||a.s.error||a.v.error)return;i&&(v&&clearInterval(v),v=setInterval(()=>{i||(u(a,V),clearInterval(v))},1));const G=new Uint32Array(a.h.compiledValue),R=new Uint32Array(a.s.compiledValue),K=new Uint32Array(a.v.compiledValue),H=new Uint32Array([+V]),x=new Uint32Array([re.END,0]),k=new WebSocket("ws://home.anb.codes:13655");i=!0,k.addEventListener("open",()=>{console.log("Sending..."),k.send(H.buffer),console.log(H),k.send(G.buffer),console.log(G),k.send(x.buffer),console.log(x),k.send(R.buffer),console.log(R),k.send(x.buffer),console.log(x),k.send(K.buffer),console.log(K),k.send(x.buffer),console.log(x)}),k.addEventListener("close",()=>{i=!1,console.log("closed")})};let l;const g=(a,V)=>()=>{const G=qe(a.value);G.error?a.error=G.error:(a.error="",a.compiledValue=G.compiled),u(V),t(0,p),t(1,l)},N=()=>{const a={h:{value:"",compiledValue:[],onChange:()=>{},error:""},s:{value:"",compiledValue:[],onChange:()=>{},error:""},v:{value:"",compiledValue:[],onChange:()=>{},error:""},name:"New Equation",open:!0};a.h.onChange=g(a.h,a),a.s.onChange=g(a.s,a),a.v.onChange=g(a.v,a),a.h.onChange(),a.s.onChange(),a.v.onChange(),p.forEach(V=>V.open=!1),p.push(a),t(0,p),t(1,l)},j=a=>{t(0,p=p.filter(V=>V!==a))};let _=!1;const M=a=>{t(1,l=a),u(l)},z=()=>{t(1,l=void 0)},Q=()=>{t(2,_=!1),l&&j(l),t(1,l=void 0)},J=()=>t(2,_=!1),W=()=>t(2,_=!0);function A(){l.name=this.value,t(1,l)}function y(){l.h.value=this.value,t(1,l)}function f(){l.s.value=this.value,t(1,l)}function O(){l.v.value=this.value,t(1,l)}const E=()=>location.reload();return e.$$.update=()=>{e.$$.dirty&3&&l&&(t(0,p),t(1,l)),e.$$.dirty&65&&d&&localStorage.setItem("equations",JSON.stringify(p))},[p,l,_,u,N,j,d,M,z,Q,J,W,A,y,f,O,E]}class ar extends Fe{constructor(r){super(),Je(this,r,tr,rr,Qe,{})}}export{ar as default};
