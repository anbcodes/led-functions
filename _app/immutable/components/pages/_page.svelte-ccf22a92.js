import{S as Ve,i as Ie,s as Pe,k as m,q as L,a as U,l as _,m as O,r as x,h as p,c as B,n as s,I as Y,b as P,G as c,J as C,B as ae,K as De,L as pe,o as Ne,u as oe,M as K,N as ce}from"../../chunks/index-f6eecf18.js";const Z={INVALID:0,SIN:1,ADD:2,SUB:3,MUL:4,DIV:5,POW:6,MOD:7,IF:8,EQ:9,GT:10,LT:11,AND:12,OR:13,VAL:14,VAR_T:15,VAR_I:16,END:17},Ce=Z,Le=e=>e.split("").map((r,t)=>r==="("?{type:"OPEN_PARAN",rawValue:r,index:t}:r===")"?{type:"CLOSE_PARAN",rawValue:r,index:t}:r===" "?{type:"WHITESPACE",rawValue:r,index:t}:r==="+"?{type:"OPERATOR",operator:"ADD",rawValue:r,index:t}:r==="-"?{type:"OPERATOR",operator:"SUB",rawValue:r,index:t}:r==="*"?{type:"OPERATOR",operator:"MUL",rawValue:r,index:t}:r==="/"?{type:"OPERATOR",operator:"DIV",rawValue:r,index:t}:r==="%"?{type:"OPERATOR",operator:"MOD",rawValue:r,index:t}:r==="^"?{type:"OPERATOR",operator:"POW",rawValue:r,index:t}:r===">"?{type:"OPERATOR",operator:"GT",rawValue:r,index:t}:r==="<"?{type:"OPERATOR",operator:"LT",rawValue:r,index:t}:r==="="?{type:"OPERATOR",operator:"EQ",rawValue:r,index:t}:r===","?{type:"OPERATOR",operator:"SEP",rawValue:r,index:t}:r==="&"?{type:"OPERATOR",operator:"AND",rawValue:r,index:t}:r==="|"?{type:"OPERATOR",operator:"OR",rawValue:r,index:t}:{type:"LITERAL",value:r,rawValue:r,index:t}),Ae=[["SEP"],["AND","OR"],["GT","LT","EQ"],["MOD"],["ADD","SUB"],["DIV","MUL"]];class q extends Error{constructor(r,t){super(r),this.index=t}}const re=(e,r)=>{if(e.length===0)throw new q("Expected an expression",r);for(let a=0;a<Ae.length;a++){const i=Ae[a];let b=0;for(let n=0;n<e.length;n++){const l=e[n];if(l.type==="OPEN_PARAN"&&(b+=1),l.type==="CLOSE_PARAN"&&(b-=1),l.type==="OPERATOR"&&b==0&&i.includes(l.operator))return{type:"operator",op:l.operator,a:re(e.slice(0,n),e[0].index+1),b:re(e.slice(n+1),l.index+1),index:l.index}}}let t="",u=-1;for(let a=0;a<e.length;a++){const i=e[a];if(i.type==="LITERAL"&&(t+=i.value,u===-1&&(u=i.index)),i.type==="OPEN_PARAN"){if(e.slice(-1)[0].type!=="CLOSE_PARAN")throw new q("Unmatched opening parenthesis",i.index);if(t){const b=re(e.slice(a+1,-1),i.index),n=[],l=g=>{g.type==="operator"&&g.op==="SEP"?(l(g.a),l(g.b)):n.push(g)};return l(b),{type:"call",name:t,args:n,index:u}}else return re(e.slice(a+1,-1),i.index)}}const d=e.find(a=>a.type!=="LITERAL");if(d)throw new q(`Unexpected token: ${d.rawValue}`,d.index);return t=e.map(a=>a.value).join(""),isNaN(parseInt(t,10))?{type:"variable",name:t,index:e[0].index}:{type:"value",val:parseInt(t,10),index:e[0].index}},X=e=>{if(e.type==="call"){if(e.name==="if")return[...X(e.args[0]),...X(e.args[1]),...X(e.args[2]),Z.IF];if(e.name==="sin")return[...X(e.args[0]),Z.SIN];throw new q(`Invalid function: ${e.name}`,e.index)}else if(e.type==="operator"){const r=Ce[e.op];if(r===void 0)throw new q(`Invalid operator: ${e.op}`,e.index);return[...X(e.a),...X(e.b),r]}else{if(e.type==="value")return[Z.VAL,e.val];if(e.type==="variable"){if(e.name==="i")return[Z.VAR_I];if(e.name==="t")return[Z.VAR_T];throw new q(`Unknown variable: ${e.name}`,e.index)}else throw new Error("INVALID TYPE")}},xe=e=>{try{const r=Le(e),t=re(r.filter(d=>d.type!=="WHITESPACE"),0);return{compiled:X(t)}}catch(r){if(r instanceof q)return{error:`Error: ${r.message}
    ${e}
    ${" ".repeat(r.index)}^`,errorRaw:r};throw r}};function Oe(e,r,t){const u=e.slice();return u[21]=r[t],u[23]=t,u}function Te(e){let r,t=e[21].name+"",u,d,a,i;function b(){return e[7](e[21])}return{c(){r=m("button"),u=L(t),this.h()},l(n){r=_(n,"BUTTON",{class:!0});var l=O(r);u=x(l,t),l.forEach(p),this.h()},h(){s(r,"class",d="border-gray-800 p-2 mx-2 border-solid border-b "+(e[21]===e[1]?"":"hover:bg-gray-200")+" active:bg-gray-300"),Y(r,"bg-gray-300",e[21]===e[1]),Y(r,"border-t",e[23]===0)},m(n,l){P(n,r,l),c(r,u),a||(i=C(r,"click",b),a=!0)},p(n,l){e=n,l&1&&t!==(t=e[21].name+"")&&oe(u,t),l&3&&d!==(d="border-gray-800 p-2 mx-2 border-solid border-b "+(e[21]===e[1]?"":"hover:bg-gray-200")+" active:bg-gray-300")&&s(r,"class",d),l&3&&Y(r,"bg-gray-300",e[21]===e[1]),l&3&&Y(r,"border-t",e[23]===0)},d(n){n&&p(r),a=!1,i()}}}function Re(e){let r,t,u,d,a,i,b,n,l,g,I,G,v,k,H,j=e[1].h.error+"",J,M,y,E,f,h,w,o,V=e[1].s.error+"",D,Q,S,z,N,A,ne,$,ee=e[1].v.error+"",te,se,de;function he(T,R){return T[2]?Se:ke}let le=he(e),F=le(e);return{c(){r=m("div"),t=m("button"),u=L("Back"),d=U(),a=m("div"),F.c(),i=U(),b=m("input"),n=U(),l=m("div"),g=m("div"),I=m("label"),G=L("h = "),v=m("input"),k=U(),H=m("pre"),J=L(j),M=U(),y=m("div"),E=m("label"),f=L("s = "),h=m("input"),w=U(),o=m("pre"),D=L(V),Q=U(),S=m("div"),z=m("label"),N=L("v = "),A=m("input"),ne=U(),$=m("pre"),te=L(ee),this.h()},l(T){r=_(T,"DIV",{class:!0});var R=O(r);t=_(R,"BUTTON",{class:!0});var be=O(t);u=x(be,"Back"),be.forEach(p),d=B(R),a=_(R,"DIV",{class:!0});var me=O(a);F.l(me),me.forEach(p),R.forEach(p),i=B(T),b=_(T,"INPUT",{type:!0,class:!0}),n=B(T),l=_(T,"DIV",{class:!0});var W=O(l);g=_(W,"DIV",{class:!0});var ie=O(g);I=_(ie,"LABEL",{for:!0});var _e=O(I);G=x(_e,"h = "),_e.forEach(p),v=_(ie,"INPUT",{name:!0,class:!0,type:!0,autocomplete:!0,autocorrect:!0,autocapitalize:!0,spellcheck:!0}),ie.forEach(p),k=B(W),H=_(W,"PRE",{});var ve=O(H);J=x(ve,j),ve.forEach(p),M=B(W),y=_(W,"DIV",{class:!0});var ue=O(y);E=_(ue,"LABEL",{for:!0});var ge=O(E);f=x(ge,"s = "),ge.forEach(p),h=_(ue,"INPUT",{name:!0,class:!0,type:!0,autocomplete:!0,autocorrect:!0,autocapitalize:!0,spellcheck:!0}),ue.forEach(p),w=B(W),o=_(W,"PRE",{});var ye=O(o);D=x(ye,V),ye.forEach(p),Q=B(W),S=_(W,"DIV",{class:!0});var fe=O(S);z=_(fe,"LABEL",{for:!0});var Ee=O(z);N=x(Ee,"v = "),Ee.forEach(p),A=_(fe,"INPUT",{name:!0,class:!0,type:!0,autocomplete:!0,autocorrect:!0,autocapitalize:!0,spellcheck:!0}),fe.forEach(p),ne=B(W),$=_(W,"PRE",{});var we=O($);te=x(we,ee),we.forEach(p),W.forEach(p),this.h()},h(){s(t,"class","text-base md:hidden rounded border-gray-800 border-solid border py-1 px-3 mb-4 hover:bg-gray-200 active:bg-gray-300"),s(a,"class","flex md:flex-row-reverse"),s(r,"class","flex justify-between"),s(b,"type","text"),s(b,"class","focus:outline-none text-2xl w-full py-3"),s(I,"for","h"),s(v,"name","h"),s(v,"class","pl-4 font-mono focus:outline-none w-full"),s(v,"type","text"),s(v,"autocomplete","off"),s(v,"autocorrect","off"),s(v,"autocapitalize","off"),s(v,"spellcheck","false"),s(g,"class","flex whitespace-nowrap py-2"),s(E,"for","s"),s(h,"name","s"),s(h,"class","pl-4 font-mono focus:outline-none w-full"),s(h,"type","text"),s(h,"autocomplete","off"),s(h,"autocorrect","off"),s(h,"autocapitalize","off"),s(h,"spellcheck","false"),s(y,"class","flex whitespace-nowrap py-2"),s(z,"for","v"),s(A,"name","v"),s(A,"class","pl-4 font-mono focus:outline-none w-full"),s(A,"type","text"),s(A,"autocomplete","off"),s(A,"autocorrect","off"),s(A,"autocapitalize","off"),s(A,"spellcheck","false"),s(S,"class","flex whitespace-nowrap py-2"),s(l,"class","pl-10")},m(T,R){P(T,r,R),c(r,t),c(t,u),c(r,d),c(r,a),F.m(a,null),P(T,i,R),P(T,b,R),K(b,e[1].name),P(T,n,R),P(T,l,R),c(l,g),c(g,I),c(I,G),c(g,v),K(v,e[1].h.value),c(l,k),c(l,H),c(H,J),c(l,M),c(l,y),c(y,E),c(E,f),c(y,h),K(h,e[1].s.value),c(l,w),c(l,o),c(o,D),c(l,Q),c(l,S),c(S,z),c(z,N),c(S,A),K(A,e[1].v.value),c(l,ne),c(l,$),c($,te),se||(de=[C(t,"click",e[8]),C(b,"input",e[12]),C(v,"input",e[13]),C(v,"input",function(){ce(e[1].h.onChange)&&e[1].h.onChange.apply(this,arguments)}),C(h,"input",e[14]),C(h,"input",function(){ce(e[1].s.onChange)&&e[1].s.onChange.apply(this,arguments)}),C(A,"input",e[15]),C(A,"input",function(){ce(e[1].v.onChange)&&e[1].v.onChange.apply(this,arguments)})],se=!0)},p(T,R){e=T,le===(le=he(e))&&F?F.p(e,R):(F.d(1),F=le(e),F&&(F.c(),F.m(a,null))),R&2&&b.value!==e[1].name&&K(b,e[1].name),R&2&&v.value!==e[1].h.value&&K(v,e[1].h.value),R&2&&j!==(j=e[1].h.error+"")&&oe(J,j),R&2&&h.value!==e[1].s.value&&K(h,e[1].s.value),R&2&&V!==(V=e[1].s.error+"")&&oe(D,V),R&2&&A.value!==e[1].v.value&&K(A,e[1].v.value),R&2&&ee!==(ee=e[1].v.error+"")&&oe(te,ee)},d(T){T&&p(r),F.d(),T&&p(i),T&&p(b),T&&p(n),T&&p(l),se=!1,pe(de)}}}function ke(e){let r,t,u,d;return{c(){r=m("button"),t=L("Delete"),this.h()},l(a){r=_(a,"BUTTON",{class:!0});var i=O(r);t=x(i,"Delete"),i.forEach(p),this.h()},h(){s(r,"class","text-base rounded border-gray-800 border-solid border py-1 px-3 mb-4 hover:bg-gray-200 active:bg-gray-300")},m(a,i){P(a,r,i),c(r,t),u||(d=C(r,"click",e[11]),u=!0)},p:ae,d(a){a&&p(r),u=!1,d()}}}function Se(e){let r,t,u,d,a,i,b;return{c(){r=m("button"),t=L("Confirm Delete"),u=U(),d=m("button"),a=L("Cancel Delete"),this.h()},l(n){r=_(n,"BUTTON",{class:!0});var l=O(r);t=x(l,"Confirm Delete"),l.forEach(p),u=B(n),d=_(n,"BUTTON",{class:!0});var g=O(d);a=x(g,"Cancel Delete"),g.forEach(p),this.h()},h(){s(r,"class","text-base rounded border-green-800 text-green-800 border-solid border py-1 px-3 mb-4 mx-2 hover:bg-gray-200 active:bg-gray-300"),s(d,"class","text-base rounded border-red-800 text-red-800 border-solid border py-1 px-3 mb-4 mx-2 hover:bg-gray-200 active:bg-gray-300")},m(n,l){P(n,r,l),c(r,t),P(n,u,l),P(n,d,l),c(d,a),i||(b=[C(r,"click",e[9]),C(d,"click",e[10])],i=!0)},p:ae,d(n){n&&p(r),n&&p(u),n&&p(d),i=!1,pe(b)}}}function Ue(e){let r,t,u,d,a,i,b,n,l,g,I,G,v,k,H,j,J,M=e[0],y=[];for(let f=0;f<M.length;f+=1)y[f]=Te(Oe(e,M,f));let E=e[1]&&Re(e);return{c(){r=m("header"),t=m("h1"),u=L("LEDS"),d=U(),a=m("div"),i=m("div");for(let f=0;f<y.length;f+=1)y[f].c();b=U(),n=m("button"),l=L("Add equation"),g=U(),I=m("div"),E&&E.c(),G=U(),v=m("div"),k=m("button"),H=L("Reload Page"),this.h()},l(f){r=_(f,"HEADER",{class:!0});var h=O(r);t=_(h,"H1",{class:!0});var w=O(t);u=x(w,"LEDS"),w.forEach(p),h.forEach(p),d=B(f),a=_(f,"DIV",{class:!0});var o=O(a);i=_(o,"DIV",{class:!0});var V=O(i);for(let N=0;N<y.length;N+=1)y[N].l(V);b=B(V),n=_(V,"BUTTON",{class:!0});var D=O(n);l=x(D,"Add equation"),D.forEach(p),V.forEach(p),g=B(o),I=_(o,"DIV",{class:!0});var Q=O(I);E&&E.l(Q),Q.forEach(p),o.forEach(p),G=B(f),v=_(f,"DIV",{class:!0});var S=O(v);k=_(S,"BUTTON",{class:!0});var z=O(k);H=x(z,"Reload Page"),z.forEach(p),S.forEach(p),this.h()},h(){s(t,"class","text-5xl "),s(r,"class","pb-10 p-5"),s(n,"class","mt-14 rounded border-gray-800 border-solid border py-4 hover:bg-gray-200 active:bg-gray-300"),s(i,"class","md:flex flex-col flex-shrink-0 text-2xl w-full md:w-[300px] md:border-r border-gray-800 border-solid pr-4"),Y(i,"hidden",e[1]),Y(i,"flex",!e[1]),s(I,"class","pl-5 flex-grow"),s(a,"class","p-4 font-sans flex"),s(k,"class","text-1xl mt-20 rounded border-gray-800 border-solid border w-36 py-2 hover:bg-gray-200 active:bg-gray-300"),s(v,"class","p-4 flex flex-col")},m(f,h){P(f,r,h),c(r,t),c(t,u),P(f,d,h),P(f,a,h),c(a,i);for(let w=0;w<y.length;w+=1)y[w].m(i,null);c(i,b),c(i,n),c(n,l),c(a,g),c(a,I),E&&E.m(I,null),P(f,G,h),P(f,v,h),c(v,k),c(k,H),j||(J=[C(n,"click",e[4]),C(k,"click",e[16])],j=!0)},p(f,[h]){if(h&11){M=f[0];let w;for(w=0;w<M.length;w+=1){const o=Oe(f,M,w);y[w]?y[w].p(o,h):(y[w]=Te(o),y[w].c(),y[w].m(i,b))}for(;w<y.length;w+=1)y[w].d(1);y.length=M.length}h&2&&Y(i,"hidden",f[1]),h&2&&Y(i,"flex",!f[1]),f[1]?E?E.p(f,h):(E=Re(f),E.c(),E.m(I,null)):E&&(E.d(1),E=null)},i:ae,o:ae,d(f){f&&p(r),f&&p(d),f&&p(a),De(y,f),E&&E.d(),f&&p(G),f&&p(v),j=!1,pe(J)}}}function Be(e,r,t){let u=[],d=!1,a=!1;Ne(()=>{window.location.protocol==="https:"&&(window.location.protocol="http:"),t(0,u=JSON.parse(localStorage.getItem("equations")||"[]")),u.forEach(o=>{o.h.onChange=g(o.h,o),o.s.onChange=g(o.s,o),o.v.onChange=g(o.v,o),o.h.onChange(),o.s.onChange(),o.v.onChange()}),a=!0,t(6,d=!0),setTimeout(()=>{document.querySelectorAll("input").forEach(o=>{o.style.width=Math.max(o.value.length+5,10)+"ch"})})});let i=!1,b;const n=(o,V=!0)=>{if(!a||o.h.error||o.s.error||o.v.error)return;i&&(b&&clearInterval(b),b=setInterval(()=>{i||(n(o,V),clearInterval(b))},1));const D=new Uint32Array(o.h.compiledValue),Q=new Uint32Array(o.s.compiledValue),S=new Uint32Array(o.v.compiledValue),z=new Uint32Array([+V]),N=new Uint32Array([Z.END,0]),A=new WebSocket("ws://home.anb.codes:13655");i=!0,A.addEventListener("open",()=>{console.log("Sending..."),A.send(z.buffer),console.log(z),A.send(D.buffer),console.log(D),A.send(N.buffer),console.log(N),A.send(Q.buffer),console.log(Q),A.send(N.buffer),console.log(N),A.send(S.buffer),console.log(S),A.send(N.buffer),console.log(N)}),A.addEventListener("close",()=>{i=!1,console.log("closed")})};let l;const g=(o,V)=>()=>{const D=xe(o.value);D.error?o.error=D.error:(o.error="",o.compiledValue=D.compiled),n(V),t(0,u),t(1,l)},I=()=>{const o={h:{value:"",compiledValue:[],onChange:()=>{},error:""},s:{value:"",compiledValue:[],onChange:()=>{},error:""},v:{value:"",compiledValue:[],onChange:()=>{},error:""},name:"New Equation",open:!0};o.h.onChange=g(o.h,o),o.s.onChange=g(o.s,o),o.v.onChange=g(o.v,o),o.h.onChange(),o.s.onChange(),o.v.onChange(),u.forEach(V=>V.open=!1),u.push(o),t(0,u),t(1,l)},G=o=>{t(0,u=u.filter(V=>V!==o))};let v=!1;const k=o=>{t(1,l=o),n(l)},H=()=>{t(1,l=void 0)},j=()=>{t(2,v=!1),l&&G(l),t(1,l=void 0)},J=()=>t(2,v=!1),M=()=>t(2,v=!0);function y(){l.name=this.value,t(1,l)}function E(){l.h.value=this.value,t(1,l)}function f(){l.s.value=this.value,t(1,l)}function h(){l.v.value=this.value,t(1,l)}const w=()=>location.reload();return e.$$.update=()=>{e.$$.dirty&3&&l&&(t(0,u),t(1,l)),e.$$.dirty&65&&d&&localStorage.setItem("equations",JSON.stringify(u))},[u,l,v,n,I,G,d,k,H,j,J,M,y,E,f,h,w]}class ze extends Ve{constructor(r){super(),Ie(this,r,Be,Ue,Pe,{})}}export{ze as default};
